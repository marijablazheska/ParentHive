<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
<div th:fragment="postbox(post, shortDisplay)" th:onclick="'location.href=\'/posts/' + ${post.id} + '\''" class="card p-3 m-1"
     th:style="${post.post_level == 2} ? 'border-left: 10px solid rgba(41, 76, 140, 0.5);'
     : (${post.post_level == 1} ? 'border-left: 10px solid rgba(68, 141, 102, 0.5);'
     : 'border-left: 10px solid rgba(255, 107, 0, 0.5);')">
    <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center">
            <!-- Profile Image -->
            <img src="https://placehold.co/40x40/cccccc/333333?text=User" alt="Profile" class="profile-img me-2">
            <div>
                <!-- Username -->
                <div class="username" th:text="${post.user.username}"></div>
                <!-- Time Ago -->
                <div class="time-ago" th:text="${post.date}"></div>
            </div>
        </div>
        <!-- Three dots icon for options -->
        <i class="fas fa-ellipsis-h stats-icon"></i>
    </div>

    <!-- Post Title -->
    <h2 class="post-title" th:text="${post.title}"></h2>

    <!-- Post Content -->
    <p class="post-content" th:utext="${shortDisplay ? (post.content.length() <= 100 ? post.content : post.content.substring(1, 99)+'...' ) : post.content}"></p>

    <!-- Tags and Stats Section -->
    <div class="d-flex justify-content-between align-items-center flex-wrap">
        <!-- Tags -->
        <div>
            <span class="tag-badge" th:text="${post.category}"></span>
            <br>
            <span class="tag-badge" th:text="${shortDisplay ? '[Read more...]' : ''}"></span>
        </div>
        <!-- Stats (Comments, Upvotes, Downvotes) -->
        <div class="d-flex align-items-center mt-2 mt-sm-0">
            <!-- Comments -->
            <div class="Interaction">
                <button onclick="toggleVisibility('replyBox', 'replyBoxButton')" class="Interaction-Button">
                    <i class="far fa-comment stats-icon"></i>
                    <span class="stats-number" th:text="${post.replies.size()}"></span>
                </button>
            </div>
            <!-- Upvotes -->
            <div class="Interaction">
                <form th:action="@{'/posts/' + ${post.id} + '/upvote'}" method="post">
                    <button type="submit" class="Interaction-Button">
                        <i class="fas fa-arrow-up stats-icon"></i>
                        <span class="stats-number" th:text="${post.upvote}"></span>
                    </button>
                </form>
            </div>
            <!-- Downvotes -->
            <div class="Interaction">
                <form th:action="@{'/posts/' + ${post.id} + '/downvote'}" method="post">
                    <button type="submit" class="Interaction-Button">
                        <i class="fas fa-arrow-down stats-icon"></i>
                        <span class="stats-number" th:text="${post.downvote}"></span>
                    </button>
                </form>
            </div>
            <!-- Repost -->
            <div class="Interaction">
                <form th:action="@{'/posts/' + ${post.id} + '/repost'}" method="post">
                    <button type="submit" class="Interaction-Button">
                        <i class="fa-solid fa-reply"></i>
                        <span th:text="${post.repost}">0</span>
                    </button>
                </form>
            </div>
            <!-- Report -->
            <div class="Interaction">
                <form th:action="@{'/posts/' + ${post.id} + '/report'}" method="GET">
                    <button type="submit" class="Interaction-Button">
                        <i class="fa-solid fa-flag"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

</div>

<div th:fragment="replybox(post)" class="card p-3 m-1"
     th:style="${post.post_level == 2} ? 'border-left: 10px solid rgba(41, 76, 140, 0.5);'
     : (${post.post_level == 1} ? 'border-left: 10px solid rgba(68, 141, 102, 0.5);'
     : 'border-left: 10px solid rgba(255, 107, 0, 0.5);')">

    <div class="d-flex align-items-center justify-content-between mb-3">
        <div class="d-flex align-items-center">
            <!-- Profile Image -->
            <img src="https://placehold.co/40x40/cccccc/333333?text=User" alt="Profile" class="profile-img me-2">
            <div>
                <!-- Username -->
                <div class="username" th:text="${post.user.username}"></div>
                <!-- Time Ago -->
                <div class="time-ago" th:text="${''}"></div>
            </div>
        </div>
        <!-- Three dots icon for options -->
        <i class="fas fa-ellipsis-h stats-icon"></i>
    </div>

    <!-- Post Content -->
    <p class="post-content" th:text="${post.content}"></p>

    <!-- Tags and Stats Section -->
    <div class="d-flex justify-content-between align-items-center flex-wrap">
        <div></div>
        <!-- Stats (Comments, Upvotes, Downvotes) -->
        <div class="d-flex align-items-center mt-2 mt-sm-0">
            <!-- Upvote -->
            <div class="Interaction">
                <form th:action="@{'/replies/' + ${reply.id} + '/upvote'}" method="post">
                    <button type="submit" class="Interaction-Button">
                        <i class="fa-solid fa-up-long"></i>
                        <span th:text="${reply.upvote}">0</span>
                    </button>
                </form>
            </div>

            <!-- Downvote -->
            <div class="Interaction">
                <form th:action="@{'/replies/' + ${reply.id} + '/downvote'}" method="post">
                    <button type="submit" class="Interaction-Button">
                        <i class="fa-solid fa-down-long"></i>
                        <span th:text="${reply.downvote}">0</span>
                    </button>
                </form>
            </div>

            <!-- Report -->
            <div class="Interaction">
                <form th:action="@{'/posts/' + ${post.id} + '/report'}" method="GET">
                    <button type="submit" class="Interaction-Button">
                        <i class="fa-solid fa-flag"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

</div>

</body>
</html>